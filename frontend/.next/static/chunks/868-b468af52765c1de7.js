"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[868],{86868:function(e,s,t){t.d(s,{OfflineIndicator:function(){return p},PWAInstallPrompt:function(){return f},y:function(){return h}});var i=t(57437),a=t(2265),n=t(14438);function r(){let[e,s]=(0,a.useState)({isInstallable:!1,isInstalled:!1,isOffline:!1,isUpdateAvailable:!1,notificationPermission:"default",pushSubscription:null}),[t,i]=(0,a.useState)(null),[r,l]=(0,a.useState)(null),o=(0,a.useCallback)(async()=>{if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return l(e),e.addEventListener("updatefound",()=>{let t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&(s(e=>({...e,isUpdateAvailable:!0})),n.A.info("App Update Available",{description:"A new version is ready. Refresh to update.",action:{label:"Refresh",onClick:()=>window.location.reload()}}))})}),console.log("Service Worker registered successfully"),e}catch(e){console.error("Service Worker registration failed:",e)}return null},[]),c=(0,a.useCallback)(async()=>{if(t)try{await t.prompt();let e=await t.userChoice;"accepted"===e.outcome&&(s(e=>({...e,isInstalled:!0,isInstallable:!1})),i(null),n.A.success("App Installed",{description:"PropertyHub has been added to your home screen!"}))}catch(e){console.error("PWA installation failed:",e),n.A.error("Installation Failed",{description:"Unable to install the app. Please try again."})}},[t]),d=(0,a.useCallback)(async()=>{if("Notification"in window)try{let e=await Notification.requestPermission();return s(s=>({...s,notificationPermission:e})),"granted"===e?n.A.success("Notifications Enabled",{description:"You will now receive push notifications."}):n.A.error("Notifications Denied",{description:"You can enable notifications in your browser settings."}),e}catch(e){console.error("Notification permission request failed:",e)}return"denied"},[]),u=(0,a.useCallback)(async()=>{if(!r)return console.error("Service Worker not registered"),null;try{let e=await r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:"your-vapid-public-key"});return s(s=>({...s,pushSubscription:e})),await fetch("/api/push/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))},body:JSON.stringify(e)}),n.A.success("Push Notifications Enabled",{description:"You will receive real-time updates."}),e}catch(e){return console.error("Push subscription failed:",e),n.A.error("Push Notifications Failed",{description:"Unable to enable push notifications."}),null}},[r]),m=(0,a.useCallback)(async()=>{if(e.pushSubscription)try{await e.pushSubscription.unsubscribe(),s(e=>({...e,pushSubscription:null})),await fetch("/api/push/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))}}),n.A.success("Push Notifications Disabled")}catch(e){console.error("Push unsubscription failed:",e)}},[e.pushSubscription]),x=(0,a.useCallback)(()=>{let e=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");s(s=>({...s,isInstalled:e}))},[]);return(0,a.useEffect)(()=>{o(),x(),"Notification"in window&&s(e=>({...e,notificationPermission:Notification.permission}));let e=e=>{e.preventDefault(),i(e),s(e=>({...e,isInstallable:!0}))},t=()=>{s(e=>({...e,isInstalled:!0,isInstallable:!1})),i(null),n.A.success("App Installed Successfully!")},a=()=>{s(e=>({...e,isOffline:!1})),n.A.success("Back Online",{description:"Connection restored. Syncing data..."})},r=()=>{s(e=>({...e,isOffline:!0})),n.A.warning("You're Offline",{description:"Some features may be limited."})};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),window.addEventListener("online",a),window.addEventListener("offline",r),s(e=>({...e,isOffline:!navigator.onLine})),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t),window.removeEventListener("online",a),window.removeEventListener("offline",r)}},[o,x]),(0,a.useEffect)(()=>{r&&r.pushManager.getSubscription().then(e=>{s(s=>({...s,pushSubscription:e}))}).catch(console.error)},[r]),{...e,installPWA:c,requestNotificationPermission:d,subscribeToPush:u,unsubscribeFromPush:m,serviceWorkerRegistration:r}}var l=t(32342),o=t(77165),c=t(2907),d=t(23121),u=t(46217),m=t(62869),x=t(66070);function f(e){let{onDismiss:s}=e,{isInstallable:t,isInstalled:n,isOffline:f,notificationPermission:p,installPWA:h,requestNotificationPermission:g,subscribeToPush:b}=r(),[v,N]=(0,a.useState)(!1),[y,j]=(0,a.useState)("install"),w=()=>{N(!0),null==s||s()},k=async()=>{await h(),j("notifications")},C=async()=>{"granted"===await g()&&await b(),j("complete")};return v||n||!t?null:(0,i.jsx)("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:w-96",children:(0,i.jsxs)(x.Zb,{className:"p-6 shadow-lg border-2 border-primary-200 bg-gradient-to-br from-primary-50 to-blue-50",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"p-2 bg-primary-100 rounded-lg",children:(0,i.jsx)(l.Z,{className:"h-6 w-6 text-primary-600"})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["install"===y&&"Install PropertyHub","notifications"===y&&"Enable Notifications","complete"===y&&"Setup Complete!"]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["install"===y&&"Get the full app experience","notifications"===y&&"Stay updated with real-time alerts","complete"===y&&"You're all set to go!"]})]})]}),(0,i.jsx)("button",{onClick:w,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:(0,i.jsx)(o.Z,{className:"h-5 w-5"})})]}),"install"===y&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,i.jsxs)("div",{className:"p-3 bg-white rounded-lg",children:[(0,i.jsx)(c.Z,{className:"h-6 w-6 text-green-500 mx-auto mb-1"}),(0,i.jsx)("p",{className:"text-xs text-gray-600",children:"Works Offline"})]}),(0,i.jsxs)("div",{className:"p-3 bg-white rounded-lg",children:[(0,i.jsx)(d.Z,{className:"h-6 w-6 text-blue-500 mx-auto mb-1"}),(0,i.jsx)("p",{className:"text-xs text-gray-600",children:"Push Notifications"})]}),(0,i.jsxs)("div",{className:"p-3 bg-white rounded-lg",children:[(0,i.jsx)(l.Z,{className:"h-6 w-6 text-purple-500 mx-auto mb-1"}),(0,i.jsx)("p",{className:"text-xs text-gray-600",children:"Native Feel"})]})]}),(0,i.jsxs)("div",{className:"flex space-x-3",children:[(0,i.jsxs)(m.z,{variant:"default",onClick:k,className:"flex-1",children:[(0,i.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Install App"]}),(0,i.jsx)(m.z,{variant:"outline",onClick:w,className:"px-4",children:"Later"})]})]}),"notifications"===y&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)(d.Z,{className:"h-8 w-8 text-blue-500"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-medium text-gray-900",children:"Real-time Updates"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Get notified about new leads, messages, and appointments instantly."})]})]})}),(0,i.jsxs)("div",{className:"flex space-x-3",children:[(0,i.jsxs)(m.z,{variant:"default",onClick:C,className:"flex-1",disabled:"denied"===p,children:[(0,i.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Enable Notifications"]}),(0,i.jsx)(m.z,{variant:"outline",onClick:()=>{j("complete")},className:"px-4",children:"Skip"})]}),"denied"===p&&(0,i.jsx)("p",{className:"text-xs text-red-600 text-center",children:"Notifications are blocked. You can enable them in your browser settings."})]}),"complete"===y&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"text-center py-4",children:[(0,i.jsx)("div",{className:"h-16 w-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,i.jsx)("svg",{className:"h-8 w-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,i.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"You're all set!"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"PropertyHub is now installed and ready to use. Enjoy the enhanced experience!"})]}),(0,i.jsx)(m.z,{variant:"default",onClick:w,className:"w-full",children:"Get Started"})]}),f&&(0,i.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("div",{className:"h-2 w-2 bg-yellow-400 rounded-full"}),(0,i.jsx)("p",{className:"text-sm text-yellow-800",children:"You're currently offline. The app will sync when connection is restored."})]})})]})})}function p(){let{isOffline:e}=r();return e?(0,i.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-yellow-500 text-white text-center py-2 text-sm font-medium",children:(0,i.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,i.jsx)("div",{className:"h-2 w-2 bg-white rounded-full animate-pulse"}),(0,i.jsx)("span",{children:"You're offline - Some features may be limited"})]})}):null}function h(){let{isInstalled:e,isOffline:s,notificationPermission:t,pushSubscription:a,requestNotificationPermission:n,subscribeToPush:l,unsubscribeFromPush:o}=r();return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"App Status"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:"Installation"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:e?"App is installed":"Running in browser"})]}),(0,i.jsx)("div",{className:"h-3 w-3 rounded-full ".concat(e?"bg-green-400":"bg-gray-400")})]})}),(0,i.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:"Connection"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:s?"Offline":"Online"})]}),(0,i.jsx)("div",{className:"h-3 w-3 rounded-full ".concat(s?"bg-red-400":"bg-green-400")})]})}),(0,i.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:"Notifications"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"granted"===t?"Enabled":"denied"===t?"Blocked":"Not set"})]}),(0,i.jsx)("div",{className:"h-3 w-3 rounded-full ".concat("granted"===t?"bg-green-400":"denied"===t?"bg-red-400":"bg-yellow-400")})]})}),(0,i.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:"Push Notifications"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:a?"Active":"Inactive"})]}),(0,i.jsx)("div",{className:"h-3 w-3 rounded-full ".concat(a?"bg-green-400":"bg-gray-400")})]})})]}),(0,i.jsxs)("div",{className:"flex space-x-3",children:["granted"!==t&&(0,i.jsx)(m.z,{variant:"outline",onClick:n,size:"sm",children:"Enable Notifications"}),"granted"===t&&!a&&(0,i.jsx)(m.z,{variant:"outline",onClick:l,size:"sm",children:"Enable Push Notifications"}),a&&(0,i.jsx)(m.z,{variant:"outline",onClick:o,size:"sm",children:"Disable Push Notifications"})]})]})}},62869:function(e,s,t){t.d(s,{z:function(){return c}});var i=t(57437),a=t(2265),n=t(37053),r=t(90535),l=t(94508);let o=(0,r.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,s)=>{let{className:t,variant:a,size:r,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,i.jsx)(u,{className:(0,l.cn)(o({variant:a,size:r,className:t})),ref:s,...d})});c.displayName="Button"},66070:function(e,s,t){t.d(s,{Zb:function(){return r}});var i=t(57437),a=t(2265),n=t(94508);let r=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...a})});r.displayName="Card",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})}).displayName="CardHeader",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("h3",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",t),...a})}).displayName="CardTitle",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})}).displayName="CardDescription",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...a})}).displayName="CardContent",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"}}]);